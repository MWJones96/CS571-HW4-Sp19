<!DOCTYPE html>
<html>
<head>
	<title>Homework 4</title>
	<meta charset="utf-8"/>
	<style type="text/css">
		body
		{
			text-align: center;
		}
	</style>
	<script type="text/javascript">
		function viewJSON(what)
		{
			function loadJSON(url)
			{
				if (window.XMLHttpRequest)
				{
					xmlhttp=new XMLHttpRequest();
				}
				else 
				{
					xmlhttp=new ActiveXObject("Microsoft.XMLHTTP");  
				}
				xmlhttp.open("GET",url,false);
				xmlhttp.send();
				jsonObj= JSON.parse(xmlhttp.responseText);
				return jsonObj;   
			}

			jsonObj = loadJSON(what);

			if (window.ActiveXObject)
			{  
				if (jsonObj.parseError.errorCode != 0) 
				{
					var myErr = jsonObj.parseError;
					generateError(jsonObj);
					hWin = window.open("", "Error", "height=300,width=340");
					hWin.document.write(html_text);
				} 
				else 
				{  
					generateHTML(jsonObj);
		    		hWin = window.open("", "Assignment4", "height=1600,width=900");
		    		hWin.document.write(html_text);   
				} 
			} 
			else
			{  
				jsonObj.onload=generateHTML(jsonObj);
				hWin = window.open("", "Assignment4", "height=1600,width=900");
				hWin.document.write(html_text);  
			} 
			hWin.document.close();  
		}

		function generateHTML(jsonObj)   
		{
			html_text="<html><head><title>JSON Parse Result</title></head><body>";
			html_text+="<table border='2'>";

			html_text+="<tbody>"; 
			html_text+="<tr>"; 

			var header_keys = jsonObj.Mainline.Table.Header.Data;

			for(i=0;i<header_keys.length;i++)           
			{
				html_text+="<th>"+header_keys[i]+"</th>";
			}

			var films = jsonObj.Mainline.Table.Row;

			for(i=0;i<films.length;i++)
			{
				html_text+="<tr>";
				html_text+="<td>"+films[i].Title+"</td>";
				html_text+="<td>"+films[i].Year+"</td>";
				html_text+="<td><ul><li><b>"+films[i].Hubs.Hub[0]+"</b></li><li>"+films[i].Hubs.Hub[1]+"</li></ul></td>";
				html_text+="<td>"+films[i].Gross+"</td>";
				html_text+="<td nowrap><a href=\""+films[i].HomePage+"\">"+films[i].HomePage+"</a></td>";
				html_text+="<td><img width=\"100\" src=\""+films[i].Logo+"\"/></td>";
				html_text+="</tr>";
			}
			                         
			html_text+="</tbody>"; 
			html_text+="</table>";           
			html_text+="</body></html>";  
		}
	</script>
</head>
<body>
	<h2>Enter URL for Highest-grossing films List JSON File</h2>
	<form name="myform" method="POST" id="location">
		<input type="text" name="URL" maxlength="255" size="25"/>
		<br>
		<br>
		<input type="button" name="submit" value="Submit Query" onClick="viewJSON(URL.value)"/>
	</form>
</body>
</html>
